---
layout: archive
permalink: /news/
title: "News"
titleshow: false
author_profile: false
toc: true
redirect_from:
  - /news/year/
---


{% include base_path %}

{% assign posts_by_year = site.posts | group_by_exp: "post", "post.date | date: '%Y'" | sort: "name" | reverse %}

{% for year_group in posts_by_year %}
  <section class="year-section">
    <h1 id="{{ year_group.name | slugify }}" class="archive__subtitle">
      {{ year_group.name }} ({{ year_group.items.size }})
    </h1>

    <div class="grid__wrapper">
      {% for post in year_group.items %}
        <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork"
                 data-tags="{{ post.tags | join: ',' | downcase }}">
          {% if post.image_path %}
            <div class="archive__item-teaser">
              <a href="{{ base_path }}{{ post.url }}" rel="permalink">
                <img
                  style="height:210px;object-fit:cover;"
                  src=
                  {% if post.image_path contains "://" %}
                    "{{ post.image_path }}"
                  {% else %}
                    "{{ post.image_path | prepend: "/images/" | prepend: base_path }}"
                  {% endif %}
                alt="{% if post.alt %}{{ post.alt }}{% endif %}">
              </a>
            </div>
          {% else %}
            <div class="archive__item-teaser">
              <a href="{{ base_path }}{{ post.url }}" rel="permalink">
                <img
                  style="height:210px;object-fit:cover;"
                  src="{{ '/images/Loading.png' | prepend: base_path }}"
                  alt="Default image">
              </a>
            </div>
          {% endif %}

          {% if post.id %}
            {% assign title = post.covertitle | markdownify | remove: "<p>" | remove: "</p>" %}
          {% else %}
            {% assign title = post.covertitle %}
          {% endif %}

          <div class="archive__item-title">
            {% if post.link %}
              <a href="{{ post.link }}">{{ title }}</a> <a href="{{ base_path }}{{ post.url }}" rel="permalink"><i class="fa fa-link" aria-hidden="true" title="permalink"></i><span class="sr-only">Permalink</span></a>
            {% else %}
              <a href="{{ base_path }}{{ post.url }}" rel="permalink">{{ title }}</a>
            {% endif %}
          </div>

          {% if post.collection == 'teaching' %}
            <div> {{ post.type }}, <i>{{ post.venue }}</i>, {{ post.date | default: "1900-01-01" | date: "%Y" }} </div>
          {% elsif post.collection == 'publications' %}
            <div>Published in <i>{{ post.venue }}</i>, {{ post.date | default: "1900-01-01" | date: "%Y" }} </div>
          {% elsif post.date %}
            <div class="page__meta"> <i class="fa fa-calendar" aria-hidden="true"></i> <time datetime="{{ post.date | default: "1900-01-01" | date_to_xmlschema }}">{{ post.date | default: "1900-01-01" | date: " %B %d, %Y" }}</time></div>
          {% endif %}

          {% if post.excerpt %}
            <small class="archive__item-excerpt" itemprop="description">{{ post.excerpt | markdownify }}</small>
          {% endif %}
        </article>

      {% endfor %}
    </div>
  </section>
{% endfor %}

<!-- 筛选功能JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // 获取所有文章
  const allArticles = document.querySelectorAll('article.archive__item');

  // 获取所有筛选按钮
  const filterButtons = document.querySelectorAll('.filter-tag');

  // 获取清除筛选按钮
  const clearButton = document.querySelector('.clear-filter');

  // 获取所有筛选组标题
  const filterGroups = document.querySelectorAll('.filter-group');

  // 存储当前激活的标签
  let activeFilters = new Set();

  // 为每个筛选标签添加点击事件
  filterButtons.forEach(button => {
    button.addEventListener('click', function() {
      const tag = this.getAttribute('data-tag');

      // 切换激活状态
      if (this.classList.contains('active')) {
        this.classList.remove('active');
        activeFilters.delete(tag);
      } else {
        this.classList.add('active');
        activeFilters.add(tag);
      }

      // 更新显示
      updateDisplay();
    });
  });

  // 清除筛选按钮
  if (clearButton) {
    clearButton.addEventListener('click', function() {
      // 清除所有激活状态
      filterButtons.forEach(button => {
        button.classList.remove('active');
      });
      activeFilters.clear();
      updateDisplay();
    });
  }

  // 更新文章显示
  function updateDisplay() {
    // 如果没有激活的筛选，显示所有文章和年份区域
    if (activeFilters.size === 0) {
      allArticles.forEach(article => {
        article.style.display = 'block';
      });

      // 显示所有年份区域
      document.querySelectorAll('.year-section').forEach(section => {
        section.style.display = 'block';
      });

      // 显示所有筛选组
      filterGroups.forEach(group => {
        group.style.display = 'block';
      });

      return;
    }

    // 隐藏所有年份区域，然后只显示有匹配文章的年份
    document.querySelectorAll('.year-section').forEach(section => {
      section.style.display = 'none';
    });

    // 显示所有筛选组（即使没有匹配的文章）
    filterGroups.forEach(group => {
      group.style.display = 'block';
    });

    // 检查每篇文章是否匹配任何激活的筛选
    allArticles.forEach(article => {
      const articleTags = article.getAttribute('data-tags').split(',').map(tag => tag.trim());

      // 检查是否有任何激活的标签匹配文章的标签
      const hasMatch = Array.from(activeFilters).some(filter =>
        articleTags.includes(filter)
      );

      article.style.display = hasMatch ? 'block' : 'none';

      // 如果文章显示，确保其父年份区域也显示
      if (hasMatch) {
        const yearSection = article.closest('.year-section');
        if (yearSection) {
          yearSection.style.display = 'block';
        }
      }
    });
  }

  // 筛选组显示/隐藏逻辑（可选：如果没有该组的任何文章，可以隐藏组标题）
  function updateFilterGroupsDisplay() {
    filterGroups.forEach(group => {
      const groupTags = group.querySelectorAll('.filter-tag');
      let hasVisibleTags = false;

      groupTags.forEach(tag => {
        const tagValue = tag.getAttribute('data-tag');
        // 检查是否有文章包含这个标签
        const hasArticleWithThisTag = Array.from(allArticles).some(article => {
          const articleTags = article.getAttribute('data-tags').split(',').map(t => t.trim());
          return articleTags.includes(tagValue);
        });

        if (hasArticleWithThisTag) {
          hasVisibleTags = true;
          tag.style.display = 'inline-block';
        } else {
          tag.style.display = 'none';
        }
      });

      // 如果该组没有可见的标签，可以隐藏整个组
      group.style.display = hasVisibleTags ? 'block' : 'none';
    });
  }

  // 初始化时也调用一次（可选）
  // updateFilterGroupsDisplay();
});
</script>


{% comment %}
<!-- {% capture written_year %}'None'{% endcapture %}
{% for post in site.posts %}
  {% capture year %}{{ post.date | date: '%Y' }}{% endcapture %}
  {% if year != written_year %}
    <h2 id="{{ year | slugify }}" class="archive__subtitle">{{ year }}</h2>
    {% capture written_year %}{{ year }}{% endcapture %}
  {% endif %}

  {% include archive-single.html type="grid" %}
{% endfor %} -->
{% endcomment %}
